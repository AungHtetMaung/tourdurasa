<!DOCTYPE html>
<html>
<head>
<meta name=viewport content="width=device-width, initial-scale=1">
<meta charset="utf-8">

<meta name="description" content="Urasa City">
<meta name="author" content="Aung Htet Maung">

<title>TripIt</title>

<!-- Bootstrap core CSS -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- Custom styles for this template -->
<link href="css/1-col-portfolio.css" rel="stylesheet">
<script type="text/javascript"
	src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script src="js/gtranslate.js"></script>
<script src="https://apis.google.com/js/api.js"></script>
<!-- Include the API client and Google+ client. -->
<script src="https://plus.google.com/js/client:platform.js" async defer></script>


<script src="js/dom.js"></script>
<script src="js/util.js"></script>
<!-- For Map
		          To be change the API key for its own google account
		      -->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript"
	src='http://maps.google.com/maps/api/js?key=AIzaSyC51n-Mqgn7fbB3bV_4s_YWJIVno6LAZAk&libraries=places&region=JP'></script>
<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="js/locationpicker.jquery.js"></script>
<script src="js/gmapcontroller.js"></script>

<script
	src="//cdnjs.cloudflare.com/ajax/libs/jquery-form-validator/2.3.26/jquery.form-validator.min.js"></script>
<script>
	$.validate({
		form : '#registration-form',
		modules : 'security',
		onError : function($form) {
			alert('Validation of form ' + $form.attr('id') + ' failed!');
		},
		onSuccess : function($form) {
			alert('The form ' + $form.attr('id') + ' is valid!');
			return false; // Will stop the submission of the form
		},
		onValidate : function($form) {
			return {
				element : $('#some-input'),
				message : 'This input has an invalid value for some reason'
			}
		},
		onElementValidate : function(valid, $el, $form, errorMess) {
			console.log('Input ' + $el.attr('name') + ' is '
					+ (valid ? 'VALID' : 'NOT VALID'));
		}
	});
</script>
<title>TripIt</title>
</head>
<body class='ctour_body'>
	<!-- Navigation -->
	<nav class="navbar navbar-inverse">
		<div class="container-fluid">
			<div class="container-fluid">
				<div class="navbar-header">
					<a class="navbar-brand" href="index.html"><span style="font-size: 2em">T</span>rip
						<small><span style="font-size: 2em">I</span>t</small></a>
					<button type="button" class="navbar-toggle" data-toggle="collapse"
						data-target="#myNavbar">
						<span class="icon-bar"></span> <span class="icon-bar"></span> <span
							class="icon-bar"></span>
					</button>
				</div>
				<div class="collapse navbar-collapse" id="myNavbar">
				<ul class="nav navbar-nav">
					<li class="active"><a href="index.html">Home</a></li>
					<li><a href="ctour.html">Share a tour</a></li>
					<li class="dropdown"><a class="dropdown-toggle"
						data-toggle="dropdown" href="#">Seasonal<span class="caret"></span></a>
						<ul class="dropdown-menu">
							<li><a href="ctour.html">Winter</a></li>
							<li><a href="#">Spring</a></li>
							<li><a href="#">Summer</a></li>
							<li><a href="#">Autumn</a></li>
							<li><a href="#">12 months enjoy</a></li>
						</ul></li>
					<li><a href="contact.html">Contact</a></li>
					<li><a href="#">About</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li><span id='google_translate_element'></span></li>
				</ul>
				</div>
			</div>
		</div>
	</nav>
	<!-- Navigation -->
	<!-- Map Input -->
	<div class="container" id ="mapcontainer">

		<!-- Map Input End -->
		<!-- Selection Map -->

		<div class="row mapdiv">
			<div class="col-6 col-md-4">
				<div id="somecomponent" class="map"></div>
				<div>
					<br> Location: <input type="text" id="somecomponent-address"
						style="width: 200px" /><br> Move the pin point to desire
					location to include as a part of a trip. You can type the place of
					the name in the text box.
				</div>
			</div>
			<div class="col-6 col-md-4">
				<div class="map" id="pano"></div>
				<div>
					<br>
					<p align="center">
						<button id="route_add">Add</button>
					</p>
					Be ensure the place is where you would like to add in the trip and
					press add.
				</div>
			</div>
			<div class="col-6 col-md-4">
				<div id="somecomponent2" class="map"></div>
				<div>
					<br>
					<p align="center">
						<button id="draw_route">Draw a route</button>
					</p>
					The pins are showing in seniority of your trip places. If you wish
					to delete a pin, click on a pin.

				</div>
			</div>
		</div>
	</div>
	<hr>
	<div class="container">
		<div class="row centered">
			<p style="font-size: 1.5em">
				Link the photo with google map,upload the photo in google map and
				paste the link in the text box.
				<button type="button" class="btn btn-primary" id='goToGoogle'>Browse</button>
			</p>
			<span id="linkBox"></span>
			<input class="form-control input-sm" id="googlePhotoLink" type="text"
				data-validation="required" data-validation-error-msg="Requred Field" />
		</div>
	</div>
	<hr>

	<div class="container">
		<div class="row centered">
			<span style="font-size: 1.5em">Trip Title</span>
		</div>
		<div class="row centered">
			<input type='text' class="form-control" data-validation="required"
				id='title' />
		</div>
		<div class="row centered">
			<span style="font-size: 1.5em">Tell the story about the trip</span>
		</div>
		<div class="row centered">
			<textarea class="form-control" rows="10" cols='100'
				data-validation="required" id='story'></textarea>
		</div>
		<div class="row centered">
			<span style="font-size: 1.5em">That best season is </span> <select
				id="season" name="season">
				<option value="all">12 months enjoy</option>
				<option value="winter">Winter</option>
				<option value="spring">Spring</option>
				<option value="summer">Summer</option>
				<option value="sutumn">Autumn</option>
			</select>
		</div>
	</div>

	<hr>
	<div class="container" id="trans">
		<div class="row centered">
			<p style="font-size: 1.5em">How could we reach there?</p>
		</div>
		<div class="row centered">
			<div class='col-md-1'>
				<button class="fa fa-train img-circle"
					style="font-size: 48px; color: black" id='train'
					onclick="faClick(this.id)"></button>
				Train
			</div>
			<div class='col-md-1'>
				<button class="fa fa-bus img-circle"
					style="font-size: 48px; color: black" id='bus'
					onclick="faClick(this.id)"></button>
				Bus
			</div>
			<div class='col-md-1'>
				<button class="fa fa-taxi img-circle"
					style="font-size: 48px; color: black" id='taxi'
					onclick="faClick(this.id)"></button>
				Taxi
			</div>
			<div class='col-md-1'>
				<button class="fa fa-car img-circle"
					style="font-size: 48px; color: black" id='car'
					onclick="faClick(this.id)"></button>
				Car
			</div>
			<div class='col-md-1'>
				<button class="fa fa-motorcycle img-circle"
					style="font-size: 48px; color: black" id='motorcycle'
					onclick="faClick(this.id)"></button>
				Motorcycle
			</div>
			<div class='col-md-1'>
				<button class="fa fa-bicycle img-circle"
					style="font-size: 48px; color: black" id='bicycle'
					onclick="faClick(this.id)"></button>
				Bicycle
			</div>
			<div class='col-md-1'>
				<button class="fa fa-street-view img-circle"
					style="font-size: 48px; color: black" id='walk'
					onclick="faClick(this.id)"></button>
				Walking
			</div>
		</div>
	</div>

	<hr>
	<div class="container">
		<div class="row centered">
			<p style="font-size: 1.5em">Tell me little more about you,</p>
		</div>
		<div class="row centered">
			<textarea class="form-control" rows="5" cols='100' id='aboutAuthor'></textarea>
		</div>
	</div>

	<hr>
	<div class="container">
		<div class="row centered">
			<button class="g-signin" data-scope="email"
				data-clientid="24492359185-ejn0mks9fon7opvnnbrekb4n9kv6fli9.apps.googleusercontent.com"
				data-callback="onSignInCallback" data-theme="dark"
				data-cookiepolicy="single_host_origin"></button>
			<p style="font-size: 1.5em">
				Hello, <span id='authorName'></span><span id='authorPhoto'></span>
			</p>
			Reader might contact you via email, <span id='email'></span>. Is
			there another way to reach you,
		</div>
		<div class="row no-gutters">
			<textarea class="form-control" rows="5" cols='100'
				id='connectionAuthor'></textarea>
			<br>
			<p align="center">
				<button class='btn btn-success' style="font-size: 30px" id='submit'>Come
					on, Let's go on a tour.</button>
			</p>
			<!-- <button id="signin-button" onclick='handleSignInClick()'>Sign
				in</button>
			<button id="signout-button" onclick="handleSignOutClick()">Sign
				out</button> -->

		</div>
	</div>
	<!-- Selection Map -->
	<input type="text" id="somecomponent-lat" class='location' />
	<input type="text" id="somecomponent-lon" class='location' />
	<!-- <button id="drop" onclick="drop()">Drop Markers</button>-->

	<footer class="py-5 bg-dark">
		<div class="footer">
			<p class="m-0 text-center text-white">Copyright &copy; SnowBit
				Soft.</p>
		</div>
	</footer>
	<script>
		valueRangeBody = '';
		media = [];
		function initClient() {
			var API_KEY = 'AIzaSyC51n-Mqgn7fbB3bV_4s_YWJIVno6LAZAk'; // TODO: Update placeholder with desired API key.
			var CLIENT_ID = '24492359185-ejn0mks9fon7opvnnbrekb4n9kv6fli9.apps.googleusercontent.com'; // TODO: Update placeholder with desired client ID.

			// TODO: Authorize using one of the following scopes:
			//   'https://www.googleapis.com/auth/drive'
			//   'https://www.googleapis.com/auth/drive.file'
			//   'https://www.googleapis.com/auth/spreadsheets'
			var SCOPE = 'https://www.googleapis.com/auth/spreadsheets';

			gapi.client
					.init(
							{
								'apiKey' : API_KEY,
								'clientId' : CLIENT_ID,
								'scope' : SCOPE,
								'discoveryDocs' : [ 'https://sheets.googleapis.com/$discovery/rest?version=v4' ],
							})
					.then(
							function() {
								gapi.auth2.getAuthInstance().isSignedIn
										.listen(updateSignInStatus);
								updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn
										.get());
								console.log('Signed In!');
							});
		}
		function updateSignInStatus(isSignedIn) {
			if (isSignedIn) {
				makeApiCall();
			} else {

				gapi.auth2.getAuthInstance().signIn();
			}
		}
		function makeApiCall() {
			//console.log('makeApiCall');
			if (validate()) {
				dataBuilder();
				//console.log('Built');
				var params = {
					spreadsheetId : "1RV45LYAbP44VIyZHPOMW6iO7qHDivPqfxhSxylr5IRQ",
					range : 'A1',
					valueInputOption : 'USER_ENTERED',
					insertDataOption : 'INSERT_ROWS'
				};
				//console.log(valueRangeBody);
				var request = gapi.client.sheets.spreadsheets.values.append(
						params, valueRangeBody);
				request.then(function(response) {
					// TODO: Change code below to process the `response` object:
					alert('Record Saved.');
					window.location.replace('./index.html');
					//console.log(response.result);
				}, function(reason) {
					console.error('error: ' + reason.result.error.message);
				});
			}
		}
		function dataBuilder() {
			console.log("dataBuilder");
			valueRangeBody = loadData();
			/* valueRangeBody = {
				values : [ [ rowIdSheet, route_list.toString() ] ]
			}; */
			//console.log(valueRangeBody);

		}
		function handleSignInClick(event) {
			gapi.auth2.getAuthInstance().signIn();
		}

		function handleSignOutClick(event) {
			gapi.auth2.getAuthInstance().signOut();
		}
		function handleClientLoad() {
			gapi.client.load('plus', 'v1', apiClientLoaded());
		}
		function makeApiCallGPlus() {
			gapi.client.plus.people.get({
				userId : 'me'
			}).execute.then(function(resp) {
				for (var i = 0; i < resp.emails.length; i++) {
					if (resp.emails[i].type === 'account')
						primaryEmail = resp.emails[i].value;
				}
				$("#authorName").text(resp.displayName);
				$("#email").text(primaryEmail);
			});
		}
		function onSignInCallback(resp) {
			gapi.client.load('plus', 'v1', apiClientLoaded);
		}
		function apiClientLoaded() {
			gapi.client.plus.people.get({
				userId : 'me'
			}).execute(handleEmailResponse);
		}
		function handleEmailResponse(resp) {
			for (var i = 0; i < resp.emails.length; i++) {
				if (resp.emails[i].type === 'account')
					primaryEmail = resp.emails[i].value;
			}
			//img = resp.image[0].url
			$("#authorName").text(resp.displayName);
			$("#email").text(primaryEmail);
			img = resp.image.url;
			$("#authorPhoto")
					.html(
							'<img src='+img+' class="img-circle" id="authorPhotoTumb"></img>');
		}
		function loadData() {
			//console.log("loadData");
			story = $('#story').val();
			aboutAuthor = $('#aboutAuthor').val();
			email = $('#email').text();
			authorName = $('#authorName').text();
			authorPhoto = $('#authorPhotoTumb').attr('src');
			connectionAuthor = $('#connectionAuthor').val();
			season = $('#season').val();
			title = $('#title').val();
			date = new Date();
			//console.log("loaded");
			valueRangeBody = {
				values : [ [ rowIdSheet.toString(), JSON.stringify(storeLoc),
						story, media.toString(), aboutAuthor, email, authorName,
						authorPhoto, connectionAuthor, tranAvai.toString(),
						season, title, date ] ]
			};
			//console.log(valueRangeBody);
			return valueRangeBody;
		}
		function validate() {
			if ($('#story').val() == "" 
					|| $('#aboutAuthor').val() == ""
					|| $('#email').text() == "" || $('#authorName').text()==""
					|| $('#authorPhotoTumb').attr('src') == ""
					|| $('#connectionAuthor').val() == ""
					|| $('#season').val() == "" || $('#title').val() == "") {
				alert("All Fields are Rquired.");
				return false;
			}
			if (storeLoc.length == 0) {
				$('html,body').animate({
			        scrollTop: $("#mapcontainer").offset().top},
			        'slow');
				alert("Select at least one location on Map.");
				return false;
			}
			if (tranAvai.length == 0) {
				 $('html,body').animate({
				        scrollTop: $("#trans").offset().top},
				        'slow');
				alert("How could we reach there?");
				return false;
			}
			if (media.length == 0) {
				 $('html,body').animate({
				        scrollTop: $("#linkBox").offset().top},
				        'slow');
				alert("Can you show some photos to your funs?");
				return false;
			}
			return true;
		}
		function deleteLink(link){
			for (var i = 0; i < media.length; i++) {
				if(media[i] === link){
					media.splice(i,1);
				}
			}
			writePhotoLink(media);
		}
		function writePhotoLink(linkArray){
			$( "#linkBox" ).empty();
			for (var i = 0; i < media.length; i++) {
     		   $( "#linkBox" ).append( "<span> <a target='_blank' href='"+ media[i]+"'>"+media[i]+"</a>" +
     		   		"<button type='button' onclick=deleteLink('"+media[i]+"') class='close' aria-label='Close'><span'>&times;</span></button></span><br>" );
     		   }
        	
        }
	</script>
	<script async defer src="https://apis.google.com/js/api.js"></script>
</body>
</html>